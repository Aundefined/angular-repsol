<div class="right-paragraph">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb" id="cls-breadcrumb">
            <li class="breadcrumb-item">
                <a href="#">Promociones</a>
            </li>
            <li class="breadcrumb-item active" aria-current="page">Gestión de Promociones</li>
        </ol>
    </nav>
    <div class="cls-form-buscar">
        <div class="form-row">
            <div class="form-group col-xs-1 col-sm-1 col-md-1 col-lg-1 mx-sm-3 mb-2">
                <label for="inputCodigo" class="lbl-title">Código: </label>
                <input type="text" maxlength="5" class="form-control form-control-sm" id="codigoFiltro" [(ngModel)]="mPromotionsFiltro.codigo"
                    name="codigo" placement="bottom" ngbTooltip="{{mPromotionsFiltro.codigo}}">
            </div>
            <div class="form-group col-xs-4 col-sm-4 col-md-4 col-lg-4 mx-sm-3 mb-2">
                <label for="inputDescripcion" class="lbl-title">Descripción:</label>
                <input type="text" class="form-control form-control-sm" id="descripcion" [(ngModel)]="mPromotionsFiltro.descripcion" name="descripción"
                    placement="bottom" ngbTooltip="{{mPromotionsFiltro.descripcion}}">
            </div>
            <div class="form-group col-xs-2 col-sm-2 col-md-2 col-lg-2 mx-sm-3 mb-2">
                <label for="inputfechadesde" class="lbl-title">Fecha desde:</label>
                <div class="form-inline input-group">
                    <input class="form-control cls-fecha" placeholder="dd/mm/yyyy" maxlength="10" (keyup)="verificarFechaRealDesde()" (blur)="asignarFechaRealDesde()"
                        ngbDatepicker #d="ngbDatepicker" [(ngModel)]="fecha_desde" name="fecha_desde">
                    <div class="form-group input-group-append">
                        <button class="btn  btnFecha" (click)="d.toggle()" type="button">
                            <img src="assets/icon-calendar.png" style="width: 1.8rem; height: 1.3rem; cursor: pointer;" placement="bottom" ngbTooltip="Seleccionar fecha"
                            />
                        </button>
                    </div>
                </div>
            </div>
            <div class="form-group col-xs-2 col-sm-2 col-md-2 col-lg-2 mx-sm-3 mb-2">
                <label for="inputfechahasta" class="lbl-title">Fecha Hasta:</label>
                <div class="form-inline input-group">
                    <input class="form-control cls-fecha" placeholder="dd/mm/yyyy" maxlength="10" (keyup)="verificarFechaRealHasta()" (blur)="asignarFechaRealHasta()"
                        ngbDatepicker #h="ngbDatepicker" [(ngModel)]="fecha_hasta" name="fecha_hasta">
                    <div class="form-group input-group-append">
                        <button class="btn  btnFecha" (click)="h.toggle()" type="button">
                            <img src="assets/icon-calendar.png" style="width: 1.8rem; height: 1.3rem; cursor: pointer;" placement="bottom" ngbTooltip="Seleccionar fecha"
                            />
                        </button>
                    </div>
                </div>
            </div>
            <!-- <div class="form-group mx-sm-3 mb-2">
                    <label for="inputFechaDesde" class="lbl-title">Fecha desde: &nbsp; </label>                
                    <input type="text"  class="form-control form-control-sm cls-fecha" id="fecha_desde"  [(ngModel)]="mPromotionsFiltro.fecha_desde" name="fecha_desde" >
            </div> -->
            <!-- <div class="form-group mx-sm-3 mb-2">
                    <label for="inputFechaHasta" class="lbl-title">Fecha hasta: &nbsp; </label>                
                    <input type="text" class="form-control form-control-sm cls-fecha" id="inputFechaHasta"   [(ngModel)]="mPromotionsFiltro.fecha_hasta" name="fecha_hasta" >
            </div> -->
            <!-- <div class="form-group mx-sm-3 mb-2" style="display: none;">
                    <label for="inputEstacion" class="lbl-title">Estación: &nbsp; </label>                
                    <input type="text"   class="form-control form-control-sm" id="inputEstacion" readonly >
                    <div class="input-group-prepend">
                        <div class="input-group-text input-icon">
                            <img src="./assets/lupita.jpg" >
                        </div>
                    </div>
                </div>                                                       -->
        </div>
        <!-- <div class="form-inline">
            <div class="form-group mx-sm-3 mb-2" style="display: none;">
                <label for="cmbProvincia" class="lbl-title">Provincia : &nbsp;</label>
                <select id="cmbProvincia" class="form-control form-control-sm">
                    <option value="0" selected>Seleccionar Provincia</option>
                    <option value="1">Barcelona</option>
                    <option value="2">Madrid</option>
                </select>
            </div>

        </div> -->
        <div class="form-row">
            <div class="form-group col-xs-3 col-sm-3 col-md-3 col-lg-3 mx-sm-3 mb-2">
                <label for="cmbTipoCaracterizacion" class="lbl-title">Tipo Caracterización : &nbsp;</label>
                <select id="cmbTipoCaracterizacion" disabled="disabled" #tipoCaracterizacion class="form-control form-control-sm">
                    <option value="0" selected>Seleccionar Tipo Caracterización</option>
                    <option value="1">Tipo 1 </option>
                    <option value="2">Tipo 2</option>
                </select>
            </div>
            <div class="form-group col-xs-3 col-sm-3 col-md-3 col-lg-3 mx-sm-3 mb-2">
                <label for="cmbValorCaracterizacion" class="lbl-title">Valor Caracterización : &nbsp;</label>
                <select id="cmbValorCaracterizacion" disabled="disabled" #valorCaracterizacion class="form-control form-control-sm">
                    <option value="0" selected>Seleccionar Valor Caracterización</option>
                    <option value="1">Valor 1 </option>
                    <option value="2">Valor 2</option>
                </select>
            </div>

            <div class="form-group col-xs-4 col-sm-4 col-md-4 col-lg-4 mx-sm-3 mb-2 ">
                <div style="float: right; text-align: center; padding-top: 30px;">
                    <button type="submit" class="btn btn-primary  mb-2  btn-repsol" (click)="limpiarFiltros()" placement="bottom" ngbTooltip="Limpiar filtros">Limpiar</button>
                    <button type="submit" class="btn btn-primary mb-2 btn-repsol" (click)="verificandoValidaciones(contentFecha)" placement="bottom"
                        ngbTooltip="Buscar promoción">Buscar</button>
                </div>
            </div>

        </div>
    </div>

    <div class="cls-content">
        <div class="cls-content-lista">
            <div class="table-responsive">
                <table class="table table-sm table-striped-alter">
                    <thead class="bg-Cabecera">
                        <tr>
                            <th scope="col" (click)="headerClickGO('code')">
                                <span class="textoHeader">Código</span>
                                <img [src]="mPromotionsFiltro.orderByGO=='code'?setClassHeaderOrder():''" />
                            </th>
                            <th scope="col" (click)="headerClickGO('Description')" style="width: 150px;">
                                <span class="textoHeader">Descripción</span>
                                <img [src]="mPromotionsFiltro.orderByGO=='Description'?setClassHeaderOrder():''" />
                            </th>
                            <th scope="col" (click)="headerClickGO('Description_Tpv')" style="width: 150px;">
                                <span class="textoHeader">Descripción Ticket</span>
                                <img [src]="mPromotionsFiltro.orderByGO=='Description_Tpv'?setClassHeaderOrder():''" />
                            </th>
                            <th scope="col" (click)="headerClickGO('V_From')" style="width: 100px;">
                                <span class="textoHeader">Fecha Desde</span>
                                <img [src]="mPromotionsFiltro.orderByGO=='V_From'?setClassHeaderOrder():''" />
                            </th>
                            <th scope="col" (click)="headerClickGO('V_To')" style="width: 100px;">
                                <span class="textoHeader">Fecha Hasta</span>
                                <img [src]="mPromotionsFiltro.orderByGO=='V_To'?setClassHeaderOrder():''" />
                            </th>
                            <th scope="col" (click)="headerClickGO('Cant_Min')" style="width: 150px;">
                                <span class="textoHeader">Artículos Necesarios</span>
                                <img [src]="mPromotionsFiltro.orderByGO=='Cant_Min'?setClassHeaderOrder():''" />
                            </th>
                            <th scope="col" (click)="headerClickGO('Pvp_Promotion')" style="width: 120px;">
                                <span class="textoHeader">Importe Promo</span>
                                <img [src]="mPromotionsFiltro.orderByGO=='Pvp_Promotion'?setClassHeaderOrder():''" />
                            </th>
                            <th scope="col" (click)="headerClickGO('Dto_Medio')" style="width: 120px;">
                                <span class="textoHeader">% DTO Medio</span>
                                <img [src]="mPromotionsFiltro.orderByGO=='Dto_Medio'?setClassHeaderOrder():''" />
                            </th>
                            <th scope="col" (click)="headerClickGO('Valor_Dto')" style="width: 140px;">
                                <span class="textoHeader">Valor DTO Medio</span>
                                <img [src]="mPromotionsFiltro.orderByGO=='Valor_Dto'?setClassHeaderOrder():''" />
                            </th>
                            <th scope="col" (click)="headerClickGO('Prioridad')" style="width: 85px;">
                                <span class="textoHeader">Prioridad</span>
                                <img [src]="mPromotionsFiltro.orderByGO=='Prioridad'?setClassHeaderOrder():''" />
                            </th>
                            <th scope="col" (click)="headerClickGO('Importe_Minimo')" style="width: 130px;">
                                <span class="textoHeader">Importe Mínimo</span>
                                <img [src]="orderByGO=='Importe_Minimo'?setClassHeaderOrder():''" />
                            </th>


                            <th scope="col" style="width: 140px;">
                                <span>Acciones</span>
                            </th>
                        </tr>
                    </thead>
                    <tbody [hidden]="!contenedor">
                        <tr class="bg-fila" *ngFor="let promotions of allPromotions">
                            <td>{{promotions.code}}</td>
                            <td>{{promotions.description}}</td>
                            <td>{{promotions.description_Tpv}}</td>
                            <td>{{promotions.v_From_str}}</td>
                            <td>{{promotions.v_To_str}}</td>
                            <td>{{promotions.cant_Min}}</td>
                            <!-- <td>{{promotions.pvp_Promotion}}</td>
                            <td>{{promotions.dto_Medio}}</td>
                            <td>{{promotions.valor_Dto}}</td> -->
                            <td> <input type="number" value="{{promotions.pvp_Promotion}}" readonly="readonly" style=" width: 5em; border: 0em; background-color: transparent;"></td>
                            <td> <input type="number" value="{{promotions.dto_Medio}}" readonly="readonly" style=" width: 5em; border: 0em; background-color: transparent;"></td>
                            <td> <input type="number" value="{{promotions.valor_Dto}}" readonly="readonly" style=" width: 5em; border: 0em; background-color: transparent;"></td>
                            <td>{{promotions.prioridad}}</td>
                            <!-- <td>{{promotions.importe_Minimo}}</td> -->
                            <td> <input type="number" value="{{promotions.importe_Minimo}}" readonly="readonly" style=" width: 5em; border: 0em; background-color: transparent;"></td>


                            <td class="cls-botton">
                                <a class="botonImage" [routerLink]="['/alta-promociones']" [queryParams]="{id:promotions.id_Promotion,action:0}"
                                    placement="bottom" ngbTooltip="Visualizar">
                                    <img src="assets/buscar.jpg" alt="buscar" />
                                </a>
                                <a class="botonImage" [routerLink]="['/alta-promociones']" [queryParams]="{id:promotions.id_Promotion,action:1}"
                                    placement="bottom" ngbTooltip="Editar">
                                    <img src="assets/editar.jpg" alt="editar" />
                                </a>
                                <a class="botonImage" (click)="showModalDarBajaPromotion(content,promotions.id_Promotion)">
                                    <img src="assets/eliminar.jpg" placement="bottom" ngbTooltip="Eliminar" alt="eliminar" />
                                </a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="row">
                <div class="col-xs-12 col-sm-12 col-md-8 col-lg-8">
                    <div *ngIf="mPromotionsFiltro.numeroPaginasGO>1?true:false" style="background-color: #ffffff;color:#eb7b31;">
                        <nav aria-label="Page navigation">
                            <ul class="pagination pagination-sm paginationTexto">
                                <li class="page-item">
                                    <a class="page-link page-color-link" (click)="paginacionClick(1)">&#60;&#60;</a>
                                </li>
                                <li class="page-item">
                                    <a (click)="paginacionClick(-1)" [class]="mPromotionsFiltro.paginaActualGO==1?'page-link page-color-link adisabled':'page-link page-color-link'">Anterior</a>
                                </li>
                                <li *ngFor="let pagina of mPromotionsFiltro.listPaginasGO" [class]="setClassActive(pagina)">
                                    <a class="page-link page-color-link" (click)="paginacionClick(pagina)">{{pagina}}</a>
                                </li>
                                <li class="page-item">
                                    <a (click)="paginacionClick(0)" [class]="mPromotionsFiltro.paginaActualGO==mPromotionsFiltro.numeroPaginasGO?'page-link page-color-link adisabled':'page-link page-color-link'">Siguiente</a>
                                </li>
                                <li class="page-item">
                                    <a class="page-link page-color-link" (click)="paginacionClick(mPromotionsFiltro.numeroPaginasGO)">&#62;&#62;</a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
        <div class="cls-form-botton">
            <a [routerLink]="['/alta-promociones']" class="btn btn-primary  mb-2  btn-repsol" placement="bottom" ngbTooltip="Crear promoción">
                <span>Crear</span>
            </a>
        </div>
    </div>
</div>

<ng-template #content let-c="close" let-d="dismiss">

    <div class="border-modal">
        <div class="modal-body">
            <div class="modal-body-content">
                <span>{{resul}}</span>
            </div>
        </div>
        <div class="modal-footer modal-footer-center">
            <button [hidden]="!ocultarBtn" type="button" class="btn btn-primary btn-repsol" (click)="darBajaPromotions(id_Promotion)">Aceptar</button>&nbsp;
            <button type="button" class="btn btn-secondary btn-repsol" (click)="c('Close click')">{{nameBtn}}</button>
        </div>
    </div>


</ng-template>

<ng-template #contentFecha let-c="close" let-d="dismiss">
    <div class="border-modal">
        <div class="modal-body">
            <div class="modal-body-content">
                <span>{{resul}}</span>
            </div>
        </div>
        <div class="modal-footer modal-footer-center">
            <button type="button" class="btn btn-primary btn-repsol" (click)="c('Close click')">Aceptar</button>&nbsp;
        </div>
    </div>
</ng-template>

<ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>